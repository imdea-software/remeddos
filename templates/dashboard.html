{% extends "base1.html" %}
{% load static %}
{% load i18n %}


{% block extrahead %}
	<link href="{% static 'b3theme/css/plugins/morris/morris-0.4.3.min.css' %}" rel="stylesheet"> 
    <link href="{% static 'b3theme/css/plugins/timeline/timeline.css' %}" rel="stylesheet">
	
    <style type="text/css">
/* 	.dl-horizontal dt {
    width: 60px;
} */
 .dl-horizontal dd {
    margin-left: 150px;
	padding : 0;
	line-height: 0%;
	
}
.timeline-panel{
	/* width: 50% !important; */
	height: 30% !important; 
}
.timeline-badge > i{
	margin-top:25%;
}

</style>
{% endblock %}

{% block title %}{% trans "Dashboard" %}{% endblock %}
{% block contentplaceholder %}
{% csrf_token %}
<div class="container">
            <div class="row">
                <div class="col  l12 m12 s12">
                    <h1 class="flow-text center">{% trans "Dashboard" %}</h1>
                </div>
                <!-- /.col-lg-12 -->
            </div>
	<div class="row">
                <div class="col l12 m12 s8 left text-grey-darken-3">
                            <i class="material-icons">access_time</i> {% trans "Timeline" %} - {% trans "Latest 10" %}
							<div class="divider"></div>
                        </div>
						
                        <!-- /.panel-heading -->
                        <div class="col l12 m12 s12">
                            <ul class="timeline">
                            	{% for route in routes %}
                                <li class="{% cycle '' 'timeline-inverted' %}">
                                    	{% if route.status == 'EXPIRED' or route.status == 'ADMININACTIVE' or route.status == 'INACTIVE' or route.status == 'OUTOFSYNC'%}
											{% if route.status == 'EXPIRED' or route.status == 'ADMININACTIVE' or route.status == 'INACTIVE' %}
												<span class="timeline-badge grey"><i class="material-icons">donut_large</i></span>
											{% else %}
												{% if route.status == 'OUTOFSYNC' %}
                                                <div class="timeline-badge red"><i class="material-icons">bug_report</i></div>
												{% else %}
                                                <div class="timeline-badge amber"><i class="material-icons">warning</i></div>
												{% endif %}
											{% endif %}
										{% else %}
											{% if route.status == 'ACTIVE' %}
                                            <span class="timeline-badge light-green "><i class="material-icons">check</i></span>
											{% else %}
												{% if route.status == 'PENDING' %}
                                                <div class="timeline-badge blue"><i class="material-icons">cached</i></div>
												{% else %}
                                                <div class="timeline-badge"><i class="material-icons">icon</i></div>
												{% endif %}
											{% endif %}
										{% endif %}

                                    <div class="timeline-panel card small">                                        
                                        <div class="timeline-heading ">
                                            <h5 class="timeline-title">{{route.name}}</h5>
                                            
                                                <p class="text-grey-lighten-4"><i class="material-icons">edit</i> 
													{% trans "Last update" %}: {{route.last_updated}} {% trans "by" %} {{route.applier_username_nice}}</p>
                                            
                                            	{% if route.expires %}
                                                <p class="text-grey-lighten-4"><i class="material-icons">access_time</i> {% trans "Expires" %}: {{ route.expires|date:"d M y" }}</p>
												{% else %}
												<p class="text-grey-lighten-4"><i class="material-icons">access_time</i> {% trans "Expires" %}: Never</p>
												{% endif %}
                                            
                                        </div>
                                        <div class="timeline-body">
                                        		<p>
                                        			{% if route.status == 'EXPIRED' or route.status == 'ADMININACTIVE' or route.status == 'INACTIVE' or route.status == 'OUTOFSYNC'%}
														{% if route.status == 'EXPIRED' or route.status == 'ADMININACTIVE' or route.status == 'INACTIVE' %}
														<span class="badge grey-text text-darken-4">DEACTIVATED</span>
														{% else %}
															{% if route.status == 'OUTOFSYNC' %}
																<span class="badge red-text text-lighten-4">ERROR</span>
															{% else %}
																<span class="badge text-blue-lighten-4">{{route.status}}</span>
															{% endif %}
														{% endif %}
													{% else %}
														{% if route.status == 'ACTIVE' %}
															<span class="badge light-green-text text-darken-3">{{route.status}}</span>
														{% else %}
															{% if route.status == 'PENDING' %}
																<span class="badge cyan-text">{{route.status}}</span>
															{% else %}
																<span class="badge amber-text">{{route.status}}</span>
															{% endif %}
														{% endif %}
													{% endif %}
                                        		</p>
											<div class="divider"></div>
											<div class="section">
												<p>{{ route.get_match|safe }}</p>
											
                                        	<dl class="dl-horizontal">
                                        		<dt>Then</dt><dd>{{ route.get_then }}</dd>
											</dl>
										</div>
										<div class="divider"></div>
										<br>
										<div col="row">
										{% ifequal route.status 'ACTIVE' %}
											<a href="{% url 'edit-route' route.name %}" class="waves-effect waves-light btn-small amber right-align" id="edit_button_{{route.pk}}">{% trans "Edit" %}</a>
											<a href="{% url 'display-graphs' route.name %}" class="waves-effect waves-light btn-small right-align" id="display_button_{{route.pk}}">{% trans "Show Graph!" %}</a>
										{% else %}
											{% if route.status == 'EXPIRED' or route.status == 'ADMININACTIVE' or route.status == 'INACTIVE' %}
												<a href="{% url 'edit-route' route.name %}" class="waves-effect waves-light btn-small right" id="edit_button_{{route.pk}}" type="button">{% trans "Reactivate" %}</a>
											{% else %}
												{% ifequal route.status 'OUTOFSYNC' %}
													<a href="{% url 'edit-route' route.name %}" class="waves-effect waves-light btn-small amber right" id="edit_button_{{route.pk}}">{% trans "ReSync" %}</a>
												{% else %}
													{% ifequal route.status 'ERROR' %}
														<a href="{% url 'edit-route' route.name %}" class="waves-effect waves-light btn-small red right" id="edit_button_{{route.pk}}">{% trans "Fix it!" %}</a>
													{% else %}
													-
													{% endifequal %}
												{% endifequal %}
											{% endif %}
										{% endifequal %}
										</div>
                                        </div>
                                    </div>
                                </li>

                                {% endfor %}
                            </ul>
                        </div>
                        <!-- /.panel-body -->
				</div>	
                    <!-- /.panel -->
            </div>
			
{% endblock %}
{% block pagejsbottom %}
{% endblock %}
