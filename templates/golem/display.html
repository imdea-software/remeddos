{% extends "../base.html" %}
{% load static %}
{% load i18n %}
{% block extrahead %}
<!-- <link rel="stylesheet" href="https://cdn.datatables.net/1.11.5/css/dataTables.bootstrap5.min.css"> -->
<link rel="stylesheet" href="{% static 'css/plugins/dataTables/style.css' %}">
<link rel="stylesheet" href="{% static 'css/plugins/dataTables/style.scss' %}">
{% endblock %}
{% block title %}{% trans "Ataques recientes" %}{% endblock %}

{% block contentplaceholder %}
<div class="container">
    <style>
        .page-item.active .page-link {
        background-color: lightgrey !important;
        border: 1px solid lightgrey;
        }
    .page-link {
        color: black !important;
        background-color: white !important;
        }
    </style>

<div class="row rows-cols-4 p-5">
    <div class="col">
        <h5 class="font-weight-light text-right">Attacks recieved by <span class="text-danger">REM-GOLEM</span></h5>
    </div>
</div>
<div class="row pt-3">
    <div class="col">
        <table id="golemtable" class="table table-striped table-bordered  table-hover table-responsive compact w-100">
        <thead class="bg-dark text-white">
           <tr>
               <th><small>ID </small></th><th><small>Type</small></th><th><small>Starts</small></th><th><small>Peer</small></th><th><small>More information</small></th> <th><small>Status</small></th> 
               <th><small>Max Value</small></th> <th><small>Threshold </small></th> <th><small>Actions</small></th>
            </tr>
        </thead>
        <tbody>
               {% for attack in attacks %}
            <tr>
                <td><small><a href="{% url 'golem-routes' attack.id_name %}" class="link-dark">{{attack.id_name}}</a></small></td>
                {% if attack.typeof_attack %} <td><small> {{attack.typeof_attack}}</small></td> {% else %} <td><small> No se registr√≥ el tipo de ataque</small></td> {% endif %}
                <td><small>{{attack.received_at}}</small></td>
                <td><small>{{attack.peer}}</small></td>
                <td><small>
                    {% if attack.ip_src %} Src Addr: {{attack.ip_src}}<br> {% endif %}
                    {% if attack.ip_dest %} Dest Addr: {{attack.ip_dest}}<br> {% endif %}
                    {% if attack.src_port %} Src Port: {{attack.src_port}}<br> {% endif %}
                    {% if attack.port %} Port: {{attack.port}}<br> {% endif %}
                    {% if attack.dest_port %} Dest. Port:{{attack.dest_port}}<br> {% endif %}
                    {% if attack.protocol.all %} Protocol: {% for p in attack.protocol.all %} {{p}} {% endfor %}<br> {% endif %}
                    {% if attack.tcpflag %} Tcpflag:  {{attack.tcpflag}} {% endif %} <br></small> </td> 
                    <td><small>{{attack.status}} </small></td>
                    <td><small>{{attack.max_value|floatformat}}/{{attack.typeof_value|title}} </small></td>
                    <td><small>{{attack.threshold_value|floatformat}}/{{attack.typeof_value|title}} </small></td> 
                    <td>
                        <a href="{% url 'golem-routes' attack.id_name %}" class="btn btn-outline btn-info" data-bs-toggle="tooltip" data-bs-placement="top" title="View rules"><i class="bi bi-bookmark-plus"></i></a>
                        <a href="{% url 'golem-updates' attack.id_name %}" class="btn btn-primary btn-outline" data-bs-toggle="tooltip" data-bs-placement="top" title="Updates"><i class="bi bi-gear-fill"></i></a>
                        <a href="{% url 'golem-delete' attack.id_name %}" class="btn btn-outline btn-danger mt-3" data-bs-toggle="tooltip" data-bs-placement="top" title="Delete golem event"><i class="bi bi-trash"></i></a>
                    </td>
            </tr>
               {% endfor %}
            </tbody>
        </table>
    
    </div>

</div>
</div>
{% endblock %}

{% block pagejsbottom %}
<script type="text/javascript" src="https://cdn.datatables.net/v/bs5/jq-3.6.0/dt-1.11.5/af-2.3.7/b-2.2.2/datatables.min.js"></script>
<script type="text/javascript">
$(document).ready(function(){
    $('#golemtable').DataTable({
        "order": [[ 1, "asc" ]],
        "AutoWidth": true,
        "aLengthMenu" : [
            [5, 15, 20, -1],
            [5, 15, 20, "All"]
        ],
        
        "Processing": true, 
        "DisplayLength": 5,
    });
})
    </script>



{% endblock %}